From eb7404c0feff24731416da4f1e459e2f0a8521c4 Mon Sep 17 00:00:00 2001
From: Jim Pivarski <jpivarski@gmail.com>
Date: Mon, 11 Apr 2022 08:38:43 -0500
Subject: [PATCH 1/2] Windows builds stopped working; be looser about directory
 name.

---
 setup.py | 16 +++++-----------
 1 file changed, 5 insertions(+), 11 deletions(-)

diff --git a/setup.py b/setup.py
index e591c85ec..24bde2a52 100644
--- a/setup.py
+++ b/setup.py
@@ -7,6 +7,7 @@
 import shutil
 import subprocess
 import sys
+import glob
 
 import setuptools
 import setuptools.command.build_ext
@@ -206,18 +207,11 @@ def run(self):
 
         if platform.system() == "Windows":
             print("--- copying libraries -----------------------------------------")
-            dlldir = os.path.join(
-                os.path.join(
-                    "build",
-                    "temp.%s-%d.%d"
-                    % (
-                        get_platform(),
-                        sys.version_info[0],
-                        sys.version_info[1],
-                    ),
-                ),
-                "Release",
+            dlldir = glob.glob(
+                f"build/temp.*-{sys.version_info[0]}.{sys.version_info[1]}/Release"
             )
+            assert len(dlldir) == 1
+            dlldir = dlldir[0]
             found = False
             for x in os.listdir(dlldir):
                 if x.endswith(".lib") or x.endswith(".exp") or x.endswith(".dll"):

From 74636253a2f8e5ff0789029c7fc3e30bda34af2f Mon Sep 17 00:00:00 2001
From: Jim Pivarski <jpivarski@gmail.com>
Date: Mon, 11 Apr 2022 09:14:54 -0500
Subject: [PATCH 2/2] The directory name doesn't even have a dot in Python
 version.

---
 setup.py | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

diff --git a/setup.py b/setup.py
index 24bde2a52..f512e11a6 100644
--- a/setup.py
+++ b/setup.py
@@ -208,9 +208,13 @@ def run(self):
         if platform.system() == "Windows":
             print("--- copying libraries -----------------------------------------")
             dlldir = glob.glob(
-                f"build/temp.*-{sys.version_info[0]}.{sys.version_info[1]}/Release"
+                os.path.join(
+                    "build",
+                    f"temp.*-{sys.version_info[0]}*{sys.version_info[1]}",
+                    "Release",
+                )
             )
-            assert len(dlldir) == 1
+            assert len(dlldir) == 1, f"glob returned {dlldir!r}"
             dlldir = dlldir[0]
             found = False
             for x in os.listdir(dlldir):
